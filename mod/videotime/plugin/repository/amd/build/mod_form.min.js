define ("videotimeplugin_repository/mod_form",["jquery","core/modal_factory","videotimeplugin_repository/modal_video_list","core/str","core/ajax"],function(a,b,c,d,f){return{init:function init(e,g){var h=a("#id_choose_video"),i=[];i.push({key:"choose_video",component:"videotime"});i.push({key:"pull_from_vimeo_loading",component:"videotime"});i.push({key:"pull_from_vimeo_invalid_videoid",component:"videotime"});i.push({key:"pull_from_vimeo_success",component:"videotime"});d.get_strings(i).done(function(d){f.call([{methodname:"videotimeplugin_repository_get_filter_options",args:{}}])[0].then(function(a){a.is_totara=e;b.create({type:c.TYPE,title:d[0],templateContext:a},h,a).done(function(a){a.setContextId(g);a.setReadOnly(!1);a.init();a.refreshTable()})});a("#id_pull_from_vimeo").on("click",function(b){var c=a(b.target).val();a(b.target).attr("value",d[1]);a(b.target).prop("disabled",!0);var e=a("#id_vimeo_url").val(),h=e.split("/")[3];if(isNaN(h)){alert(d[2]);a(b.target).attr("value",c);a(b.target).prop("disabled",!1);return}var i=f.call([{methodname:"videotimeplugin_repository_api_request",args:{url:"/videos/"+h,contextid:g}}]);i[0].done(function(e){var f=JSON.parse(e.data);if(200!=f.status){alert("API error: "+f.body.error);a(b.target).attr("value",c);a(b.target).prop("disabled",!1);return}var g=f.body;alert(d[3]);a("#id_name").val(g.name);a("#id_introeditor").val(g.description);a("#id_introeditoreditable").html(g.description);a("#id_completion_on_view_time_second").val(g.duration);a("#fitem_id_tags .form-autocomplete-selection").empty();a("#fitem_id_tags #id_tags").empty();a.each(g.tags,function(b,c){a("#fitem_id_tags #id_tags").append("<option data-iscustom=\"true\" value=\""+c.name+"\" selected>"+c.name+"</option>");a("#fitem_id_tags .form-autocomplete-selection").append("<span role=\"listitem\" data-value=\""+c.name+"\" aria-selected=\"true\" class=\"label label-info\"><span aria-hidden=\"true\">\xD7 </span>"+c.name+"</span>")});a(b.target).attr("value",c);a(b.target).prop("disabled",!1)}.bind(this))})}.bind(this))}}});
//# sourceMappingURL=mod_form.min.js.map
